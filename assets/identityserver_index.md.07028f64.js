import{_ as n,y as s,x as a,W as t}from"./plugin-vue_export-helper.ac3310fd.js";const h='{"title":"IdentityServer, OpenID Connect/OAuth-2","description":"","frontmatter":{},"headers":[{"level":2,"title":"flows","slug":"flows"},{"level":2,"title":"oidc-client.js (Code Flow + PKCE)","slug":"oidc-client-js-code-flow-pkce"},{"level":2,"title":"Alternative: Backends for Frontends (BFF)","slug":"alternative-backends-for-frontends-bff"}],"relativePath":"identityserver/index.md","lastUpdated":1653835935266}',o={},e=t(`<h1 id="identityserver-openid-connect-oauth-2" tabindex="-1">IdentityServer, OpenID Connect/OAuth-2 <a class="header-anchor" href="#identityserver-openid-connect-oauth-2" aria-hidden="true">#</a></h1><h2 id="flows" tabindex="-1">flows <a class="header-anchor" href="#flows" aria-hidden="true">#</a></h2><ul><li>Client Credentials Flow <ul><li>client_credentials</li><li>server-to-server communication</li><li>token endpoint</li></ul></li><li>Authorization Code Flow (OAuth2) <ul><li>response_type: code</li><li>user-centric clients</li><li>authorize endpoint</li></ul></li><li>Hybrid Flow (OpenID Connect) <ul><li>more secure then Authorization Code Flow</li><li>response_type: code id_token</li><li>user-centric clients</li><li>authorize endpoint</li></ul></li><li>Proof Key for Code Exchange (PKCE) <ul><li>also works without a client secret</li><li>per request client secret</li><li>responst_type: code</li></ul></li><li>Implicit flow is outdated (almost deprecated) <ul><li>Use Code Flow + PKCE instead (One flow for all)</li></ul></li></ul><h2 id="oidc-client-js-code-flow-pkce" tabindex="-1">oidc-client.js (Code Flow + PKCE) <a class="header-anchor" href="#oidc-client-js-code-flow-pkce" aria-hidden="true">#</a></h2><div class="language-js"><pre><code><span class="token keyword">var</span> settings <span class="token operator">=</span> <span class="token punctuation">{</span>
  authority<span class="token operator">:</span> <span class="token string">&quot;https://localhost:5001&quot;</span><span class="token punctuation">,</span>
  client_id<span class="token operator">:</span> <span class="token string">&quot;myClient&quot;</span><span class="token punctuation">,</span>
  redirect_uri<span class="token operator">:</span> <span class="token string">&quot;http://localhost:5000/callback&quot;</span><span class="token punctuation">,</span>
  response_type<span class="token operator">:</span> <span class="token string">&quot;code&quot;</span><span class="token punctuation">,</span>
  scope<span class="token operator">:</span> <span class="token string">&quot;openid profile api&quot;</span><span class="token punctuation">,</span>
  post_logout_redirect_uri<span class="token operator">:</span> <span class="token string">&quot;http://localhost:5000/index.html&quot;</span><span class="token punctuation">,</span>
  automaticSilentRenew<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  silent_redirect_uri<span class="token operator">:</span> <span class="token string">&quot;http://localhost:5000/silent.html&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> mgr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Oidc<span class="token punctuation">.</span>UserManager</span><span class="token punctuation">(</span>settings<span class="token punctuation">)</span><span class="token punctuation">;</span>

mgr<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;logged in&quot;</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;user is not logged in&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  mgr<span class="token punctuation">.</span><span class="token function">signinRedirect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  mgr<span class="token punctuation">.</span><span class="token function">signoutRedirect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">silent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  mgr
    <span class="token punctuation">.</span><span class="token function">signinSilent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;silent renew&quot;</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="alternative-backends-for-frontends-bff" tabindex="-1">Alternative: Backends for Frontends (BFF) <a class="header-anchor" href="#alternative-backends-for-frontends-bff" aria-hidden="true">#</a></h2><ul><li>Proxy Api <ul><li>handles tokens</li><li><a href="https://github.com/damianh/ProxyKit" target="_blank" rel="noopener noreferrer">ProxyKit</a></li></ul></li><li>SPA uses cookie to Proxy (can be http-only and SameSite: Strict)</li><li><a href="https://leastprivilege.com/2019/01/18/an-alternative-way-to-secure-spas-with-asp-net-core-openid-connect-oauth-2-0-and-proxykit/" target="_blank" rel="noopener noreferrer">Blog post</a></li></ul>`,7),p=[e];function c(l,i,u,r,k,d){return a(),s("div",null,p)}var g=n(o,[["render",c]]);export{h as __pageData,g as default};
